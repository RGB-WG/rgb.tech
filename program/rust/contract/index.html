<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>RGB smart contracts</title>
  <link rel="stylesheet" href="/tachyons-ext.css">
  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="/front.css">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta http-equiv="pragma" content="no-cache">
  
    <meta name="description" content="">

    <meta property="og:title" content="Writing simple contract" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://rgb.tech/rgb-banner.png" />
    <meta name="twitter:card" content="summary_large_image">

    <meta property="og:description" content="">
    <meta property="og:site_name" content="RGB protocol">

    <meta name="twitter:site" content="@lnp_bp">

</head>

<body>
<nav class="flex flex-row justify-center justify-end-l items-center flex-wrap ph2 pl3-ns pr3-ns pb3">
  <div id="logo" class="flex-auto w-100 w-auto-l self-start self-center tc tl-l">
    <a href="/">
      <img alt="RGB Logo" src="/logo/rgb-symbol-color.svg">
    </a>
  </div>
  <ul class="nav list w-100 w-auto-l flex flex-none flex-row flex-wrap justify-center justify-end-l items-center pv2 ph0 ph4-ns">
    <li class="tc pv2 ph2 ph4-ns flex-20-s"><a href="/install">Install</a></li>
    <li class="tc pv2 ph2 ph4-ns flex-20-s"><a href="/learn">Learn</a></li>
    <!-- li class="tc pv2 ph2 ph4-ns flex-20-s">Tools</li -->
    <li class="tc pv2 ph2 ph4-ns flex-20-s"><a href="/governance">Governance</a></li>
    <li class="tc pv2 ph2 ph4-ns flex-20-s"><a href="https://t.me/rgbtelegram">Community</a></li>
    <li class="tc pv2 ph2 ph4-ns flex-20-s"><a href="/blog">Blog</a></li>
  </ul>
</nav>
<main>
  
<section class="section-white">
    <div>
        <header class="pb0">
            <h1>Writing simple contract</h1>
            <div class="highlight"></div>
        </header>

        <p>Firstly, using cargo to create a new project: <code>cargo new rgb20-token</code>, and enter
it: <code>cd rgb20-token</code>. Then create a directory to store the contract file. You may
name it whatever you like, here we set it to <code>examples</code>: <code>mkdir examples</code>.
See source codes at <a href="https://github.com/bitlightlabs/bitlight-rgb20-contract">RGB20 Contract</a>.</p>
<p>Here is the complete project file tree:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>➜  rgb20-token git:(main) ✗ tree .
</span><span>.
</span><span>├── Cargo.lock
</span><span>├── Cargo.toml
</span><span>├── contracts
</span><span>└── src
</span><span>    └── main.rs
</span><span>
</span><span>3 directories, 3 files
</span></code></pre>
<p>Secondly, we add some libs in <code>Cargo.toml</code> file:</p>
<pre data-lang="toml" style="background-color:#2b303b;color:#c0c5ce;" class="language-toml "><code class="language-toml" data-lang="toml"><span>[package]
</span><span style="color:#bf616a;">name </span><span>= &quot;</span><span style="color:#a3be8c;">rgb20-token</span><span>&quot;
</span><span style="color:#bf616a;">version </span><span>= &quot;</span><span style="color:#a3be8c;">0.1.0</span><span>&quot;
</span><span style="color:#bf616a;">edition </span><span>= &quot;</span><span style="color:#a3be8c;">2021</span><span>&quot;
</span><span style="color:#bf616a;">resolver </span><span>= &quot;</span><span style="color:#a3be8c;">2</span><span>&quot;
</span><span>
</span><span>[dependencies]
</span><span style="color:#bf616a;">amplify </span><span>= &quot;</span><span style="color:#a3be8c;">4.7.0</span><span>&quot;
</span><span style="color:#bf616a;">bp-core </span><span>= &quot;</span><span style="color:#a3be8c;">0.11.0</span><span>&quot;
</span><span style="color:#bf616a;">rgb-std </span><span>= { </span><span style="color:#bf616a;">version </span><span>= &quot;</span><span style="color:#a3be8c;">0.11.0</span><span>&quot;, </span><span style="color:#bf616a;">features </span><span>= [&quot;</span><span style="color:#a3be8c;">serde</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">fs</span><span>&quot;] }
</span><span style="color:#bf616a;">rgb-schemata </span><span>= &quot;</span><span style="color:#a3be8c;">0.11.0</span><span>&quot;
</span><span style="color:#bf616a;">serde </span><span>= &quot;</span><span style="color:#a3be8c;">1.0</span><span>&quot;
</span><span style="color:#bf616a;">serde_json </span><span>= &quot;</span><span style="color:#a3be8c;">1.0</span><span>&quot;
</span><span>
</span><span>[features]
</span><span style="color:#bf616a;">all </span><span>= []
</span></code></pre>
<p>Then, in <code>src/main.rs</code>, write following codes:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">use </span><span>amplify::hex::FromHex;
</span><span style="color:#b48ead;">use </span><span>bp::dbc::Method;
</span><span style="color:#b48ead;">use </span><span>bp::{Outpoint, Txid};
</span><span style="color:#b48ead;">use </span><span>ifaces::Rgb20;
</span><span style="color:#b48ead;">use </span><span>rgbstd::containers::{ConsignmentExt, FileContent};
</span><span style="color:#b48ead;">use </span><span>rgbstd::interface::{FilterIncludeAll, FungibleAllocation};
</span><span style="color:#b48ead;">use </span><span>rgbstd::invoice::Precision;
</span><span style="color:#b48ead;">use </span><span>rgbstd::persistence::Stock;
</span><span style="color:#b48ead;">use </span><span>rgbstd::XWitnessId;
</span><span style="color:#b48ead;">use </span><span>schemata::dumb::NoResolver;
</span><span style="color:#b48ead;">use </span><span>schemata::NonInflatableAsset;
</span><span>
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>    </span><span style="color:#b48ead;">let</span><span> beneficiary_txid = 
</span><span>        Txid::from_hex(&quot;</span><span style="color:#a3be8c;">311ec7d43f0f33cda5a0c515a737b5e0bbce3896e6eb32e67db0e868a58f4150</span><span>&quot;).</span><span style="color:#96b5b4;">unwrap</span><span>();
</span><span>    </span><span style="color:#b48ead;">let</span><span> beneficiary = Outpoint::new(beneficiary_txid, </span><span style="color:#d08770;">1</span><span>);
</span><span>
</span><span>    </span><span style="color:#b48ead;">let</span><span> contract = NonInflatableAsset::testnet(
</span><span>        &quot;</span><span style="color:#a3be8c;">ssi:anonymous</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">TEST</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">Test asset</span><span>&quot;,
</span><span>        None,
</span><span>        Precision::CentiMicro,
</span><span>        [(Method::TapretFirst, beneficiary, </span><span style="color:#d08770;">1_000_000_000_00</span><span style="color:#b48ead;">u64</span><span>)]
</span><span>    )
</span><span>    .</span><span style="color:#96b5b4;">expect</span><span>(&quot;</span><span style="color:#a3be8c;">invalid contract data</span><span>&quot;);
</span><span>
</span><span>    </span><span style="color:#b48ead;">let</span><span> contract_id = contract.</span><span style="color:#96b5b4;">contract_id</span><span>();
</span><span>
</span><span>    eprintln!(&quot;</span><span style="color:#d08770;">{contract}</span><span>&quot;);
</span><span>    contract.</span><span style="color:#96b5b4;">save_file</span><span>(&quot;</span><span style="color:#a3be8c;">examples/rgb20-simplest.rgb</span><span>&quot;).</span><span style="color:#96b5b4;">expect</span><span>(&quot;</span><span style="color:#a3be8c;">unable to save contract</span><span>&quot;);
</span><span>    contract.</span><span style="color:#96b5b4;">save_armored</span><span>(&quot;</span><span style="color:#a3be8c;">examples/rgb20-simplest.rgba</span><span>&quot;).</span><span style="color:#96b5b4;">expect</span><span>(&quot;</span><span style="color:#a3be8c;">unable to save armored contract</span><span>&quot;);
</span><span>
</span><span>    </span><span style="color:#65737e;">// Let&#39;s create some stock - an in-memory stash and inventory around it:
</span><span>    </span><span style="color:#b48ead;">let mut</span><span> stock = Stock::in_memory();
</span><span>    stock.</span><span style="color:#96b5b4;">import_contract</span><span>(contract, NoResolver).</span><span style="color:#96b5b4;">unwrap</span><span>();
</span><span>
</span><span>    </span><span style="color:#65737e;">// Reading contract state through the interface from the stock:
</span><span>    </span><span style="color:#b48ead;">let</span><span> contract = stock.contract_iface_class::&lt;Rgb20&gt;(contract_id).</span><span style="color:#96b5b4;">unwrap</span><span>();
</span><span>    </span><span style="color:#b48ead;">let</span><span> allocations = contract.</span><span style="color:#96b5b4;">allocations</span><span>(&amp;FilterIncludeAll);
</span><span>    eprintln!(&quot;</span><span style="color:#96b5b4;">\n</span><span style="color:#a3be8c;">The issued contract data:</span><span>&quot;);
</span><span>    eprintln!(&quot;</span><span style="color:#d08770;">{}</span><span>&quot;, serde_json::to_string(&amp;contract.</span><span style="color:#96b5b4;">spec</span><span>()).</span><span style="color:#96b5b4;">unwrap</span><span>());
</span><span>
</span><span>    </span><span style="color:#b48ead;">for</span><span> FungibleAllocation  { seal, state, witness, .. } in allocations {
</span><span>        </span><span style="color:#b48ead;">let</span><span> witness = witness.</span><span style="color:#96b5b4;">as_ref</span><span>().</span><span style="color:#96b5b4;">map</span><span>(XWitnessId::to_string).</span><span style="color:#96b5b4;">unwrap_or</span><span>(&quot;</span><span style="color:#a3be8c;">~</span><span>&quot;.</span><span style="color:#96b5b4;">to_owned</span><span>());
</span><span>        eprintln!(&quot;</span><span style="color:#a3be8c;">amount=</span><span style="color:#d08770;">{state}</span><span style="color:#a3be8c;">, owner=</span><span style="color:#d08770;">{seal}</span><span style="color:#a3be8c;">, witness=</span><span style="color:#d08770;">{witness}</span><span>&quot;);
</span><span>    }
</span><span>    eprintln!(&quot;</span><span style="color:#a3be8c;">totalSupply=</span><span style="color:#d08770;">{}</span><span>&quot;, contract.</span><span style="color:#96b5b4;">total_supply</span><span>());
</span><span>}
</span><span>
</span></code></pre>
<p>Save it, and execute <code>cargo run</code>, after that, contract file would save in
<code>examples</code> directory. You can specify your own token name, decimal,
description, beneficiary and supply by modifying corresponding variable's value,
as well as contracts saving fold.</p>
<p>Now, you can import the contract with <code>rgb import</code> command:
<code>rgb import examples/rgb20-simplest.rgb</code>.</p>

    </div>
</section>

</main>

<footer><div class="w-100 mw-none ph3 mw8-m mw9-l center f3">
  <div class="flex flex-column flex-row-ns pv0-l">
    <div class="flex flex-column mw8 w-100 measure-wide-l pv2 pv5-m pv2-ns ph4-m ph4-l">
      <h4>Get help!</h4>
      <ul>
        <li><a href="http://rgbfaq.com">RGB FAQ</a></li>
        <li><a href="https://blackpaper.rgb.tech">White paper</a></li>
        <li><a href="/docs">Documentation</a></li>
        <li><a href="https://standards.lnp-bp.org">Standards</a></li>
      </ul>
    </div>
    <div class="flex flex-column mw8 w-100 measure-wide-l pv2 pv5-m pv2-ns ph4-m ph4-l">
      <h4>Terms and policies</h4>
      <ul>
        <li><a href="/policies/licenses">Licenses</a></li>
        <li><a href="/policies/logo-policy-and-media-guide/">Logo Policy and Media Guide</a></li>
        <li><a href="/policies/security">Security Disclosures</a></li>
        <li><a href="/policies/privacy-policy/">Privacy Notice</a></li>
      </ul>
    </div>
    <div class="flex flex-column mw8 w-100 measure-wide-l pv2 pv5-m pv2-ns ph4-m ph4-l">
      <h4>Social</h4>
      <div class="flex flex-row flex-wrap">
        <a href="https://twitter.com/lnp_bp"><img src="/social/twitter.svg" alt="twitter logo" title="Twitter"></a>
        <a href="https://www.youtube.com/LNP-BP"><img class="pv2" src="/social/youtube.svg" alt="youtube logo" title="YouTube"></a>
        <a href="https://reddit.com/r/RGB_protocol"><img src="/social/reddit.svg" alt="discord logo" title="Discord"></a>
        <a href="https://github.com/RGB-WG"><img src="/social/github.svg" alt="github logo" title="GitHub"></a>
      </div>
    </div>

  </div>
  <div class="attribution">
    <p>
      Maintained by the <a href="https://www.lnp-bp.org">LNP/BP Standards Association</a>. See a bug?
      <a href="https://github.com/RGB-WG/rgb.tech/issues/new">File an issue!</a>
    </p>
    <p>Uses layout &amp; styles from <a href="https://github.com/rust-lang/www.rust-lang.org" target="_blank">Rust Language website</a></p>
  </div>
</div>

</footer>
</body>

</html>
